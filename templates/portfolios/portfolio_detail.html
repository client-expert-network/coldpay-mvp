{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block vendor_css %}
  <link rel="stylesheet" href="{% static 'vendor/libs/node-waves/node-waves.css' %}" />
  <link rel="stylesheet" href="{% static 'vendor/libs/perfect-scrollbar/perfect-scrollbar.css' %}" />
  <link rel="stylesheet" href="{% static 'vendor/libs/typeahead-js/typeahead.css' %}" />
{% endblock %}

{% block content %}
  {% include 'partials/navbar.html' %}

  <div class="container px-4 px-lg-5">
    <!-- Heading Row -->
    <div class="row gx-4 gx-lg-5 align-items-center my-5">
      {% comment %} <div class="col-lg-7">
        <img class="img-fluid rounded mb-4 mb-lg-0" src="https://dummyimage.com/900x400/dee2e6/6c757d.jpg" alt="..." />
      </div> {% endcomment %}
      <div class="col-lg-5">
        <h2 class="font-weight-light">{{ portfolio.title }}</h2>
        {% comment %} <p>This is a template that is great for small businesses. It doesn't have too much fancy flare to it, but it makes a great use of the standard Bootstrap core components. Feel free to use this template for any project you want!</p>
        <a class="btn btn-primary" href="#!">Call to Action!</a> {% endcomment %}
        <div>
          <span>프로젝트 기간:</span> {{ portfolio.portfolio_start }} - {{ portfolio.portfolio_end }} <br />
          <span>프로젝트 예산:</span> {{ portfolio.price|intcomma }}원 <br />
        </div>
        <div>
          {% if portfolio.expert == user %}
            <a href="{% url 'update_portfolio' portfolio.id %}" class="btn btn-secondary">Edit</a>
            <form action="{% url 'delete_portfolio' portfolio.id %}" method="post" style="display: inline;">
              {% csrf_token %}
              <input type="hidden" name="_method" value="DELETE" />
              <button type="submit" class="btn btn-danger">Delete</button>
            </form>
          {% endif %}
        </div>
      </div>
    </div>
    <!-- Call to Action -->
    <div class="card my-5 py-4">
      <div class="card-body">{{ portfolio.htmlcontent|safe }}</div>
    </div>
    <!-- Content Row -->
    <h3>다른 포트폴리오</h3>
    {% if other_portfolios %}
      <div class="row gx-4 gx-lg-5">
        {% for other_portfolio in other_portfolios %}
          <div class="col-md-4 mb-5">
            <div class="card h-100">
              <div class="card-body">
                <h2 class="card-title"><a href="{% url 'portfolio_detail' other_portfolio.id %}">{{ other_portfolio.title }}</a></h2>
                <div class="text-truncate">
                  <p class="card-text">{{ other_portfolio.htmlcontent|truncatechars:100|safe }}</p>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>

  {% comment %} <div class="container px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 align-items-center my-5">
      <h2>
        <a href="{% url 'profiles:user_profile' portfolio.expert.username %}">
          <img src="{% if portfolio.expert.profile_picture %}
              {{ portfolio.expert.profile_picture }}
            {% else %}
              {% static 'img/front-pages/icons/user.png' %}
            {% endif %}"
            alt="Profile Picture"
            style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px;" />
          {{ portfolio.expert.username }}
        </a>
      </h2>
      <h1 class="font-weight-light">{{ portfolio.title }}</h1>
      <div class="image-container">
        <img class="img-fluid rounded mb-4 mb-lg-0" />
        <div class="overlay-content">{{ portfolio.htmlcontent|safe }}</div>
      </div>
      <div class="col-lg-5" style="margin-top: 2px;">
        <p>Price: {{ portfolio.price }}</p>
        <p>Duration: {{ portfolio.get_duration }}</p>
        <p>Start Date: {{ portfolio.portfolio_start }}</p>
        <p>End Date: {{ portfolio.portfolio_end }}</p>
        <p>Views: {{ portfolio.show }}</p>
        <p>Likes: {{ portfolio.like }}</p>
        <div class="action-buttons">
          <form action="{% url 'portfolio_detail' portfolio.id %}" method="post" style="display: inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary">Like</button>
          </form>
          {% if portfolio.expert == request.user %}
            <a href="{% url 'update_portfolio' portfolio.id %}" class="btn btn-secondary">Edit</a>
            <form action="{% url 'delete_portfolio' portfolio.id %}" method="post" style="display: inline;">
              {% csrf_token %}
              <input type="hidden" name="_method" value="DELETE" />
              <button type="submit" class="btn btn-danger">Delete</button>
            </form>
          {% endif %}
        </div>
      </div>
    </div>
    <br />
    <br />
    <div class="card text-white bg-secondary my-5 py-4 text-center" style="width: 500px; height: 100px;">
      <div class="card-body d-flex justify-content-center align-items-center" style="height: 100%;">
        <p class="text-white m-0" style="font-size: 30px;">이 전문가의 다른 포트폴리오</p>
      </div>
    </div>
    <br />
    <br />
    {% if other_portfolios %}
      <div class="row gx-4 gx-lg-5">
        {% for other_portfolio in other_portfolios %}
          <div class="col-md-4 mb-5">
            <div class="card h-100">
              <div class="card-img-top" style="height: 200px; width: 100%; overflow: hidden;">
                <div style="width: 100%; height: 100%; object-fit: cover;">{{ other_portfolio.htmlcontent|safe }}</div>
              </div>
              <div class="card-body">
                <h2 class="card-title">{{ other_portfolio.title }}</h2>
                <a href="{% url 'profiles:user_profile' other_portfolio.expert.username %}" class="card-text d-flex align-items-center">
                  <img src="{{ other_portfolio.expert.profile_picture }}" alt="Profile Picture" class="rounded-circle me-2" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px;" />
                  {{ other_portfolio.expert.username }}
                </a>
                <br />
                <br />
                <p class="card-text">Views: {{ other_portfolio.show }}</p>
                <p class="card-text">Likes: {{ other_portfolio.like }}</p>
                <div class="card-footer">
                  <a href="{% url 'portfolio_detail' other_portfolio.id %}" class="btn btn-outline-primary">View Portfolio</a>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>이 전문가의 다른 포트폴리오가 없습니다.</p>
    {% endif %}
  </div> {% endcomment %}
{% endblock %}
